graph TD
    %% CLIENT ACCESS LAYER
    subgraph CL[CLIENT ACCESS LAYER]
        MP[Mobile Payment<br/>React Native/Flutter<br/>- iOS/Android<br/>- Payment UI<br/>- Secure Storage] 
        PT[POS Terminal<br/>Spring Boot/JavaPOS<br/>- EMV Processing<br/>- Card Present<br/>- Receipt Print]
        WP[Web Payment<br/>Next.js/React<br/>- Checkout<br/>- Payment Form<br/>- Card Tokenize]
        SP[Smart POS<br/>Spring Boot/Android SDK<br/>- Android POS<br/>- Linux POS<br/>- mPOS Support]
    end

    %% CHANNEL INTEGRATION LAYER
    subgraph CI[CHANNEL INTEGRATION LAYER]
        MS[Mobile SDK<br/>Native SDK/WebView<br/>- Secure Comm.<br/>- Encryption]
        PI[POS Integration<br/>JavaPOS/OPOS<br/>- Terminal Mgmt<br/>- Hardware Intg]
        PS[Payment SDK<br/>JavaScript/WebSocket<br/>- JS Library<br/>- Tokenization]
        TS[Terminal SDK<br/>Android SDK/Native<br/>- Device Mgmt<br/>- Firmware Update]
    end

    %% EXTERNAL PAYMENT ECOSYSTEM
    subgraph EP[EXTERNAL PAYMENT ECOSYSTEM]
        CN[Card Networks<br/>Visa/MC]
        DW[Digital Wallets<br/>Apple/Google]
        BS[Banking Systems<br/>SWIFT/ACH]
        AP[Alternative Payments<br/>Crypto/BNPL]
    end

    %% PAYMENT GATEWAY LAYER
    subgraph PG[PAYMENT GATEWAY & INTEGRATION]
        GW[Payment Gateway<br/>Spring Boot/Camel<br/>- Protocol Handler<br/>- Routing Logic]
        NI[Card Network Interface<br/>Custom/Socket.io<br/>- ISO8583<br/>- Socket Conn.]
        BI[Bank Integration<br/>Spring Int./Camel<br/>- ISO20022<br/>- SWIFT/ACH]
        WI[Wallet Integration<br/>Payment SDK/REST<br/>- SDK/API<br/>- OAuth Flow]
    end

    %% SECURITY & COMPLIANCE LAYER
    subgraph SC[SECURITY & COMPLIANCE]
        AG[API Gateway<br/>Kong/Istio<br/>- Rate Limiting<br/>- Load Balance]
        AU[Authentication<br/>Keycloak<br/>- OAuth/OIDC<br/>- MFA]
        EN[Encryption<br/>Vault/HSM<br/>- Key Mgmt<br/>- Tokenization]
        CO[Compliance<br/>Custom/Vanta<br/>- PCI DSS<br/>- KYC/AML]
    end

    %% CORE PAYMENT SERVICES LAYER
    subgraph CP[CORE PAYMENT SERVICES]
        PO[Payment Orchestrator<br/>Spring Cloud/K8s<br/>- Payment Flow<br/>- Routing]
        TP[Transaction Processor<br/>Spring Boot/SAGA<br/>- State Machine<br/>- ACID]
        FD[Fraud Detection<br/>TensorFlow/Spring<br/>- ML Models<br/>- Rules Engine]
        RM[Risk Management<br/>Spring Boot/ML<br/>- Scoring<br/>- Rules]
    end

    %% BUSINESS SERVICES LAYER
    subgraph BS[BUSINESS SERVICES]
        MM[Merchant Management<br/>Spring Boot/PostgreSQL<br/>- Onboarding<br/>- Configuration]
        CM[Customer Management<br/>Spring Boot/MongoDB<br/>- Profile<br/>- Preferences]
        SS[Settlement Service<br/>Spring Batch/Quartz<br/>- Batch Process<br/>- Fee Calc]
        RS[Reconciliation Service<br/>Spring Boot/Spark<br/>- Matching<br/>- Reports]
    end

    %% DATA PERSISTENCE LAYER
    subgraph DP[DATA PERSISTENCE]
        TD[Transaction DB<br/>PostgreSQL/TimescaleDB<br/>- ACID<br/>- Sharding]
        CD[Customer DB<br/>MongoDB/Cassandra<br/>- Document Store<br/>- Scalable]
        MD[Merchant DB<br/>PostgreSQL/MySQL<br/>- Relational<br/>- Consistent]
        AD[Audit DB<br/>Elasticsearch/TimescaleDB<br/>- Time Series<br/>- Immutable]
    end

    %% MESSAGING & CACHING LAYER
    subgraph MC[MESSAGING & CACHING]
        ES[Event Stream<br/>Apache Kafka/EventStore<br/>- Real-time<br/>- Event Source]
        MQ[Message Queue<br/>RabbitMQ/ActiveMQ<br/>- Async<br/>- Reliable]
        CS[Cache Service<br/>Redis Cluster/Hazelcast<br/>- Data Cache<br/>- Response Cache]
        ST[State Store<br/>Redis/etcd<br/>- Session<br/>- Distributed]
    end

    %% MONITORING & OPERATIONS LAYER
    subgraph MO[MONITORING & OPERATIONS]
        SM[System Monitor<br/>Prometheus/Grafana<br/>- Metrics<br/>- Health Check]
        TM[Transaction Monitor<br/>Datadog/New Relic<br/>- Performance<br/>- Tracing]
        LA[Log Analytics<br/>ELK Stack/Splunk<br/>- Centralized<br/>- Searchable]
        AL[Alerting<br/>PagerDuty/OpsGenie<br/>- Real-time<br/>- Escalation]
    end

    %% DEVOPS & DEPLOYMENT LAYER
    subgraph DD[DEVOPS & DEPLOYMENT]
        CD[CI/CD Pipeline<br/>Jenkins/GitLab<br/>- Build/Test<br/>- Deploy]
        CO[Container Orchestration<br/>Kubernetes/Docker<br/>- Orchestration<br/>- Scaling]
        CM[Config Manager<br/>Spring Cloud/Consul<br/>- App Config<br/>- Secrets]
        IN[Infrastructure<br/>Terraform/Ansible<br/>- Cloud Infra<br/>- Network]
    end

    %% Layer Connections
    CL --> CI
    CI --> EP
    EP --> PG
    PG --> SC
    SC --> CP
    CP --> BS
    BS --> DP
    DP --> MC
    MC --> MO
    MO --> DD

    %% Cross-layer Dependencies
    CP -.-> MC
    BS -.-> MC
    SC -.-> MO
    PG -.-> MO
